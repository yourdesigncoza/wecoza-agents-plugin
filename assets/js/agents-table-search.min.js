/**
 * Agents Table Search JavaScript (Minified)
 * @package WeCozaAgents
 * @since 1.0.0
 */
!function(e){"use strict";const t={debounceDelay:300,minSearchLength:0,searchInputSelector:".search-input.search.form-control-sm",tableSelector:"#agents-display-data",tableRowSelector:"tbody tr",itemsPerPage:20,searchableColumns:[0,1,2,3,4,5,6,7]};let n=null,a=null,i=null,r=null,s=0,o=0,l=1,c=1,u=[],d=null,p=!1;function g(){if(p)return void console.log("WeCoza Agents: Already initialized, skipping duplicate initialization");if(a=e(t.searchInputSelector),i=e(t.tableSelector),r=i.find(t.tableRowSelector),0===a.length)return void console.warn("WeCoza Agents: Search input not found");if(0===i.length)return void console.warn("WeCoza Agents: Table not found");if(0===r.length)return void console.warn("WeCoza Agents: No table rows found");s=r.length,o=s,a.on("input keyup paste",function(){m(e(this).val())}),a.closest("form").on("reset",function(){setTimeout(function(){h("")},10)}),function(){e("#agents-search-status").length>0||e("<span>",{id:"agents-search-status",class:"badge badge-phoenix badge-phoenix-primary mb-2",style:"display: none;"}).insertBefore(i)}(),function(){e("#agents-pagination").length>0?d=e("#agents-pagination"):(d=e("<div>",{id:"agents-pagination",class:"d-flex justify-content-between mt-3"}),i.closest(".fixed-table-body").after(d));u=r.toArray().map(t=>e(t)),s=u.length,o=s,function(){c=Math.ceil(u.length/t.itemsPerPage),0===c&&(c=1),l>c&&(l=c),l<1&&(l=1)}()}(),f(),p=!0,console.log("WeCoza Agents: Table search and pagination initialized successfully")}function m(e){n&&clearTimeout(n),n=setTimeout(function(){h(e)},t.debounceDelay)}function h(n){const a=n.toLowerCase().trim();u=[],r.each(function(){const n=e(this),i=n.find("td");if(0===i.length)return;let r=!0;a.length>=t.minSearchLength&&(r=function(e,n){for(let a=0;a<t.searchableColumns.length;a++){const i=t.searchableColumns[a],r=e.eq(i);if(0===r.length)continue;const s=r.text().toLowerCase().trim();if(s.includes(n))return!0;if(s.split(/[\s:,.-]+/).filter(e=>e.length>0).some(e=>e.startsWith(n)))return!0}return!1}(i,a)),r&&u.push(n)}),o=u.length,l=1,f(),function(t,n,a){const i=e("#agents-search-status");if(0===i.length)return;if(0===t.trim().length)return void i.hide();let r="";0===n?r=`No agents found matching "${t}"`:n===a?r=`Showing all ${a} agents`:r=`Showing ${n} of ${a} agents matching "${t}"`,i.text(r).show()}(n,o,s)}function f(){!function(){c=Math.ceil(u.length/t.itemsPerPage),0===c&&(c=1),l>c&&(l=c),l<1&&(l=1)}(),r.hide();const e=(l-1)*t.itemsPerPage,n=e+t.itemsPerPage;for(let t=e;t<n&&t<u.length;t++)u[t].show();!function(){if(!d)return;const e=0===u.length?0:(l-1)*t.itemsPerPage+1,n=Math.min(l*t.itemsPerPage,u.length),a=u.length;let i="";i+=a>0?`<span class="d-none d-sm-inline-block" data-list-info="data-list-info">\n                ${e} to ${n} <span class="text-body-tertiary"> Items of </span>${a}\n            </span>`:'<span class="d-none d-sm-inline-block" data-list-info="data-list-info">\n                0 <span class="text-body-tertiary"> Items of </span>0\n            </span>',i+='<nav aria-label="Agents pagination">',i+='<ul class="pagination pagination-sm">',i+=l<=1?'<li class="page-item disabled">\n                <span class="page-link" aria-hidden="true">&laquo;</span>\n            </li>':'<li class="page-item">\n                <a class="page-link" href="#" data-list-pagination="prev" aria-label="Previous">\n                    <span aria-hidden="true">&laquo;</span>\n                </a>\n            </li>';for(let e=1;e<=c;e++)i+=e===l?`<li class="page-item active" aria-current="page">\n                    <span class="page-link">${e}</span>\n                </li>`:`<li class="page-item">\n                    <a class="page-link" href="#" data-page-number="${e}">${e}</a>\n                </li>`;i+=l>=c?'<li class="page-item disabled">\n                <span class="page-link" aria-hidden="true">&raquo;</span>\n            </li>':'<li class="page-item">\n                <a class="page-link" href="#" data-list-pagination="next" aria-label="Next">\n                    <span aria-hidden="true">&raquo;</span>\n                </a>\n            </li>',i+="</ul>",i+="</nav>",d.html(i),function(){d&&(d.off("click.pagination").on("click.pagination",'[data-list-pagination="prev"]',function(t){t.preventDefault(),t.stopImmediatePropagation(),e(this).closest(".page-item").hasClass("disabled")||b(l-1)}),d.off("click.pagination").on("click.pagination",'[data-list-pagination="next"]',function(t){t.preventDefault(),t.stopImmediatePropagation(),e(this).closest(".page-item").hasClass("disabled")||b(l+1)}),d.off("click.pagination").on("click.pagination","[data-page-number]",function(t){t.preventDefault(),t.stopImmediatePropagation();const n=parseInt(e(this).data("page-number"));n!==l&&b(n)}))}()}()}function b(e){e<1||e>c||(l=e,f())}window.WeCozaAgentsSearch={init:g,reset:function(){a&&(a.val(""),l=1,h(""))},resetPagination:function(){l=1,f()},goToPage:b,getStats:function(){return{totalRows:s,visibleRows:o,filteredRows:u.length,searchTerm:a?a.val():"",isSearchActive:!!a&&a.val().trim().length>0,currentPage:l,totalPages:c,itemsPerPage:t.itemsPerPage}},forceReinit:function(){p=!1,g()}},e(document).ready(function(){setTimeout(function(){g()},100)})}(jQuery);